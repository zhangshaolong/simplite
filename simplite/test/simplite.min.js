!function(t,e){var r=e();"function"==typeof define?define(function(){return r}):"undefined"==typeof require?t.Simplite=r:module.exports=r}(this,function(){"use strict";var t=Array.prototype.slice,e=function(t,e){for(var r in t)e[r]||(e[r]=t[r]);return e},r=function(t){return t=t||{},{logicOpenTag:t.logicOpenTag||"<%",logicCloseTag:t.logicCloseTag||"%>",attrOpenTag:t.attrOpenTag||"{{",attrCloseTag:t.attrCloseTag||"}}",dataKey:t.dataKey||"_this",compiles:{},templates:{},filters:t.filters||{escape:function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","\\":"\\\\"},e=/\\|&|<|>|"|'/g;return function(r){return"undefined"==typeof r?"":"string"!=typeof r?r:r.replace(e,function(e){return t[e]})}}()}}},n=function(t){e(r(t),this)};e(r(),n),n.addFilter=function(t,e,r){(r||n).filters[t]=e},n.getFilter=function(t,e){return(e||n).filters[t]},n.addTemplate=function(t,e,r){(r||n).templates[t]=e},n.filter=function(e){return this.filters[e].apply(this,t.call(arguments,1))},n.include=function(t,e){var r=arguments.length;if(r>2){var o=arguments[r-1];e={};for(var i=1;i<r-1;i++){var a=arguments[i];if(null!=a)if(a.constructor===Object)for(var l in a)e[l]=a[l];else e=a}if(e.constructor===Object&&null!=o&&o.constructor===Object)for(var l in o)e.hasOwnProperty(l)||(e[l]=o[l])}return n.render(t,e,this)};var o=/(^|[^\s])\s*(include|filter)\s*\(([^;]+)\)/g,i=/^\s*filter\(/g,a=/"/g,l=/\//g,c=/\-\-s\-\-/g,u="--s--",s=/(?:(["'])[\s\S]*?\1)|(?:\/\/.*\n)|(?:\/\*([\s\S])*?\*\/)|(?:\>\s+\<)|(?:\s+)/g,p=function(t){var e=t.charAt(0);switch(e){case"/":return"";case'"':case"'":return t;case">":return"><";default:return" "}},f=function(t,e){return"#"===e.charAt(0)?'"+_t.defaultAttr(_t.filter("escape",'+e.slice(1).replace(i,"_t.filter(")+'))+"':'"+_t.defaultAttr('+e.replace(i,"_t.filter(")+')+"'},g=function(t,e){var r=[];return t.replace(e.attrTagReg,function(t){return r.push(t),u}).replace(l,"\\/").replace(a,'\\"').replace(c,function(){return r.shift()})};return n.compile=function(t,e){e=e||n;try{var r=new Function(e.dataKey,e.toCodeBlock(e.templates[t],e));return function(t){return r.call(e,t)}}catch(o){throw console&&console.log&&console.log(t,o.stack||o),o}},n.render=function(t,e,r){r=r||n;var o=r.compiles[t];return o||(o=r.compiles[t]=n.compile(t,r)),o(e)},n.toCodeBlock=function(t,e){var r=function(t,r,n,o){return"."===r?t:(r||"")+" _o+=_t."+n+"("+o+","+e.dataKey+")\n"};e=e||n;var i=e.attrTagReg,a=e.logicOpenTagReg,l=e.logicCloseTagReg,c=e.htmlReg;i||(i=e.attrTagReg=new RegExp(e.attrOpenTag+"([\\s\\S]+?)"+e.attrCloseTag,"g"),a=e.logicOpenTagReg=new RegExp("(?=\\s?)"+e.logicOpenTag+"\\s?","g"),l=e.logicCloseTagReg=new RegExp("\\s?"+e.logicCloseTag+"(?=\\s?)","g"),c=e.htmlReg=new RegExp("(?:"+e.logicCloseTag+"|^)(?:(?!"+e.logicOpenTag+")[\\s\\S])+?(?:$|"+e.logicOpenTag+")","g"));var u=t.replace(c,function(t){return g(t,e)}).replace(s,p).replace(i,f).replace(a,'";').replace(l,'\n_o+="').replace(o,r);return'"use strict"\nvar _t=this,_o="'+u+'";return _o;'},n.defaultAttr=function(t){return null==t?"":t},n.prototype.compile=function(t){return n.compile(t,this)},n.prototype.render=function(t,e){return n.render(t,e,this)},n.prototype.addFilter=function(t,e){n.addFilter(t,e,this)},n.prototype.getFilter=function(t){return n.getFilter(t,this)},n.prototype.addTemplate=function(t,e){n.addTemplate(t,e,this)},n.prototype.filter=function(t){return n.filter.apply(this,arguments)},n.prototype.include=function(t,e){return n.include.apply(this,arguments)},n.prototype.defaultAttr=function(t){return n.defaultAttr(t)},n});